---
title: 'HR Data Analysis'
author: 'Mustafa Tilkat'
date: '24 Oct 2016'
output:
  html_document:
    number_sections: true
    toc: true
    fig_width: 7
    fig_height: 4.5
    theme: readable
    highlight: tango
---

# Introduction

There are multiple worksheets within the Excel workbook. 

These include;

* Core data set
* Production staff
* Sales analysis
* Salaries
* Recruiting sources

The workbook revolves around a fictitious company, called Dental Magic, and the core data set contains names, DOBs, age, gender, marital status, date of hire, reasons for termination, department, whether they are active or terminated, position title, pay rate, manager name, and performance score.

## Load and check data

Here's several helpful packages to load in R.

```{r, message = FALSE}
# Load packages
library(ggplot2) # Data visualization
library(readr) # CSV file I/O, e.g. the read_csv function
library('dplyr')
library('tidyr')
library(ggplot2)
library(lubridate)
library(highcharter)
```

Now that our packages are loaded, let's read in and take a peek at the data.

```{r, message=FALSE, warning=FALSE}
hr <- read.csv("C:/Users/HP/Desktop/BDA/BDA 503/HR/core_dataset.csv")
# check data
str(hr)
```

We've got a sense of our variables, their class type, and the first few observations of each. We know we're working with 302 observations of 21 variables. 
What about the summary of the fields. Let's have a look.
```{r}
summary(hr)
```

We have one NA in our dataset. Lets remove it out.

```{r}
#remove 'NAs'
hr <-na.omit(hr)
```

Also there is some lowercase mismatch in "Sex" and Hispanic.Latino fields.

```{r}
#fix missmatch
hr$Sex[hr$Sex =="male"] <-'Male'
hr$Hispanic.Latino[hr$Hispanic.Latino =="no"] <-'No'
hr$Hispanic.Latino[hr$Hispanic.Latino =="yes"] <-'Yes'
summary(hr$Sex)
summary(hr$Hispanic.Latino)
```

# Basic Statistics and Graphs

When we look at the data, the graph of "Sex"" status of the employees whose status is "still employed" seems to be at the following.

There are 108 employees in our database, 107 of them are women, and 81 of them are males.


```{r}

  sexstatus <-hr %>%
  filter(Reason.For.Term=="N/A - still employed") %>%
  group_by(Sex) %>%
  summarise(Total=n())

  hchart(sexstatus,type="column",hcaes(x=Sex,y=Total)) %>%
  hc_add_theme(hc_theme_google())
```

* The highest number of employees is in the "Production Technician I" position.
* "Production Technician I" and "Production Technician II" has highgest female staff
* All senior managment positions are occupied by female Staff
```{r}
  on_roll_emp <-hr %>%
  filter(Reason.For.Term=="N/A - still employed") %>%
  group_by(Sex,Position) %>%
  summarise(Total=n())

  hchart(on_roll_emp,type="column",hcaes(x=Position,y=Total,group=Sex)) %>%
  hc_add_theme(hc_theme_google())
```

Is there any bias in Payrate against any particular Race.Lets see!

```{r}
plot1 <-ggplot(hr,aes(x=RaceDesc,y=Pay.Rate)) +
       geom_boxplot() +
       ggtitle("Pay Rate Vs Races-All ")
       
plot1
       
```

```{r}
       plot2 <-hr %>% filter(Reason.For.Term=="N/A - still employed") %>%
        ggplot(aes(x=RaceDesc,y=Pay.Rate)) +
        geom_boxplot() +
        ggtitle("Pay Rate Vs Races for On Roll Employees")

plot2
```

It can be seen that Hispanics pay rate is fairly good from others.

Lets look at Source of recruitment. 

```{r}
Hr_Rect_Source <-hr %>% group_by(Employee.Source) %>%summarise(Total=n()) %>%arrange(desc(Total))
ggplot(Hr_Rect_Source,aes(reorder(Employee.Source,Total),y=Total)) +
  geom_bar(stat="identity") +
  coord_flip() +
  ggtitle("Source of Recruitment")
```

Most of the source of the employment is through from "Employee Referral" is followed by "Diversity Job Fair".

When we look at gender wise source of employees we can see that interstingly female ftaff has been recruited via "Job Sites"" and male staff has been recruited via "Employee Referral"

```{r}
HR_Gender_Wise <-hr%>%group_by(Employee.Source,Sex) %>%summarise(Total=n())

ggplot(HR_Gender_Wise,aes(reorder(Employee.Source,Total),Total,fill=Total)) +
  geom_bar(stat="identity") +
  coord_flip() +
  facet_wrap(~Sex) +
  ggtitle("Recruitment Mode Gender Wise")
```

Production Department has highly skilled labours which meets company expectations , also it has highest number of employees whose performance not upto the mark(Needs improvement/PIP)

```{r}
Dept_Wise_Performance <-hr %>%
  filter(Performance.Score !='N/A- too early to review') %>%
  count(Department,Performance.Score)

Dept_Wise_Performance

ggplot(Dept_Wise_Performance,aes(x=Department,y=n,fill=Performance.Score)) +
  geom_bar(stat="identity",position="dodge") +
  ggtitle("Performace of Employees On Roll-Dept Wise")


 hchart(Dept_Wise_Performance,type="column",hcaes(x=Department,y=n,group=Performance.Score)) %>%
   hc_add_theme(hc_theme_google()) %>%
   hc_title(text="Departmentwise Employee Performance ") %>%
   hc_xAxis(title=list(text="Department")) %>%
   hc_yAxis(title=list(text="No.of Employees"))
```

When we look at which group works better according to gender, we can see that female staffs are leading the performance ratings.

```{r}
Gender_Wise_Performance <- hr%>%filter(Performance.Score !='N/A- too early to review') %>%
                            count(Sex,Performance.Score)
 
 Gender_Wise_Performance
 colnames(Gender_Wise_Performance) <-c("Sex","Performance.Score","Total.No.Employees")

 ggplot(Gender_Wise_Performance,aes(x=Performance.Score,y=Total.No.Employees,fill=Sex)) +
   geom_bar(stat="identity",color="green",position = "dodge") +
   ggtitle("Performance Rating for On roll Employees-Gender Wise")
```

When we look at the managers, the answer of which Manager gives better rating is  

```{r}
 Manager_Wise <-hr%>%group_by(Manager.Name,Performance.Score)%>%summarise(Total=n())
 
 ggplot(Manager_Wise,aes(x=Performance.Score,y=Total,fill=Performance.Score)) +
   geom_bar(stat="identity",position="dodge") +
   facet_wrap(~Manager.Name) +
   theme(axis.text.x = element_text(angle=90)) +
   ggtitle("Manager Wise Performance Rating")
   
```

David Stanely and Janet King gives better rating ,and if you are working under Branon Miller there could be more chances you may get PIP rating(Performance Improvement Programme)

#Conclusion

Thank you for taking the time to read through my first exploration of a Kaggle dataset. I look forward to doing more. Again, this newbie welcomes comments and suggestions!